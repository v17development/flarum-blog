{"version":3,"sources":["webpack://@v17development/flarum-blog/webpack/bootstrap","webpack://@v17development/flarum-blog/external \"flarum.core.compat['forum/app']\"","webpack://@v17development/flarum-blog/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@v17development/flarum-blog/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/components/Button']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/utils/ItemList']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/Component']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/components/Link']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/extend']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/components/Switch']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/helpers/icon']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/Model']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/components/Modal']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/utils/classList']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/components/Alert']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/utils/Stream']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/components/Page']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/components/Tooltip']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['components/IndexPage']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['tags/components/TagDiscussionModal']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/components/Dropdown']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/utils/extractText']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/helpers/listItems']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['forum/components/ModalManager']\"","webpack://@v17development/flarum-blog/./node_modules/@babel/runtime/regenerator/index.js","webpack://@v17development/flarum-blog/external \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['forum/components/PostStream']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['forum/states/PostStreamState']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['forum/components/EditPostComposer']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/helpers/avatar']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/components/SelectDropdown']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/helpers/fullTime']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['tags/models/Tag']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/models/Discussion']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/utils/mixin']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['tags/components/TagsPage']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['forum/components/ComposerBody']\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/components/TextEditor']\"","webpack://@v17development/flarum-blog/external \"flarum.core\"","webpack://@v17development/flarum-blog/external \"flarum.core.compat['common/components/LinkButton']\"","webpack://@v17development/flarum-blog/./node_modules/regenerator-runtime/runtime.js","webpack://@v17development/flarum-blog/external \"flarum.extensions['fof-upload']\"","webpack://@v17development/flarum-blog/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@v17development/flarum-blog/./src/forum/utils/selectFiles.ts","webpack://@v17development/flarum-blog/./src/forum/components/Modals/BlogPostSettingsModal.js","webpack://@v17development/flarum-blog/./src/forum/components/Modals/RenameArticleModal.js","webpack://@v17development/flarum-blog/./src/forum/components/BlogPostController.js","webpack://@v17development/flarum-blog/./src/forum/components/BlogItemSidebar/BlogAuthor.js","webpack://@v17development/flarum-blog/./src/forum/components/BlogCategories.js","webpack://@v17development/flarum-blog/./src/forum/components/ForumNav.js","webpack://@v17development/flarum-blog/./src/forum/components/BlogItemSidebar/BlogItemSidebar.js","webpack://@v17development/flarum-blog/./src/forum/components/LanguageDropdown/Language.js","webpack://@v17development/flarum-blog/./src/forum/components/LanguageDropdown/LanguageDropdown.js","webpack://@v17development/flarum-blog/./src/forum/components/BlogOverviewItem.tsx","webpack://@v17development/flarum-blog/./src/forum/components/FeaturedBlogItem.tsx","webpack://@v17development/flarum-blog/./src/forum/pages/BlogOverview.js","webpack://@v17development/flarum-blog/./src/forum/components/ArticleSubscription.js","webpack://@v17development/flarum-blog/./src/forum/pages/BlogItem.js","webpack://@v17development/flarum-blog/./src/common/Models/BlogMeta.js","webpack://@v17development/flarum-blog/./src/forum/utils/extendTagOverview.js","webpack://@v17development/flarum-blog/./src/forum/utils/discussionRouting.js","webpack://@v17development/flarum-blog/./src/forum/components/Composer/ComposerPreview.js","webpack://@v17development/flarum-blog/./src/forum/components/Composer/Composer.js","webpack://@v17development/flarum-blog/./src/forum/pages/BlogComposer.js","webpack://@v17development/flarum-blog/./src/forum/utils/addSidebarNav.js","webpack://@v17development/flarum-blog/./src/forum/states/OverrideModalState.ts","webpack://@v17development/flarum-blog/./src/forum/index.js","webpack://@v17development/flarum-blog/./src/forum/utils/redirector.js","webpack://@v17development/flarum-blog/./src/forum/utils/overrideModalManager.js","webpack://@v17development/flarum-blog/./src/forum/compat.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","_setPrototypeOf","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","constructor","require","runtime","Op","hasOwn","$Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","define","obj","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","context","Context","_invoke","state","method","arg","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","type","done","makeInvokeMethod","fn","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","AsyncIterator","PromiseImpl","previousPromise","callInvokeWithMethodAndArg","resolve","reject","invoke","result","__await","then","unwrapped","error","undefined","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","displayName","isGeneratorFunction","genFun","ctor","mark","awrap","async","Promise","iter","toString","keys","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","Function","extensions","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","selectFiles","BlogPostSettingsModal","oninit","vnode","attrs","article","meta","blogMeta","app","store","createRecord","isNew","exists","summary","Stream","featuredImage","isFeatured","isSized","isPendingReview","className","title","content","fields","toArray","items","ItemList","add","style","maxWidth","minWidth","width","minHeight","bidi","placeholder","fofUploadButton","forum","attribute","components","Uploader","FileManagerModal","uploader","class","onclick","a","modal","show","onSelect","files","file","getById","url","icon","data-upload-enabled","src","alt","marginTop","Switch","component","onchange","val","fontWeight","Button","loading","submitData","relationships","isComposer","discussion","onsubmit","e","preventDefault","pushData","attributes","hide","save","redraw","response","handleErrors","Modal","RenameArticleModal","redirect","translator","trans","onChange","slug","route","set","window","history","replaceState","document","BlogPostController","init","loadedPost","manageArticleButtons","LanguageDiscussionModal","canRename","articlePost","firstPost","disabled","canEdit","composer","load","EditPostComposer","post","canTag","TagDiscussionModal","alerts","Alert","canChangeLanguage","canLock","DiscussionControls","lockAction","isLocked","canHide","isHidden","restoreAction","canDelete","buttons","confirm","extractText","getCurrent","previous","back","hideAction","view","Dropdown","label","buttonClassName","menuClassName","onshow","Component","BlogAuthor","author","user","backgroundColor","color","href","username","avatar","bio","listItems","BlogCategories","blogCategories","map","tagId","tag","tags","showSubTags","param","all","_tag","isChild","parent","categoryItem","id","ForumNav","navItems","IndexPage","BlogItemSidebar","itemlist","Language","languages","options","reduce","lang","code","extra","language","uppercase","toUpperCase","LanguageDropdown","selected","defaultSelected","formatter","locale","active","BlogOverviewItem","titleItems","text","dataItems","humanTime","createdAt","commentCount","contentItems","getImage","defaultImage","blogImage","classList","backgroundImage","FeaturedBlogItem","topItems","isSticky","position","BlogOverview","setTitle","bodyClass","isLoading","featuredPosts","posts","hasMore","isLoadingMore","currentSelectedLanguage","loadBlogOverview","featuredCount","parseInt","showCategories","showForumNav","preloadBlogOverview","preloadedApiDocument","setTimeout","reloadData","q","find","filter","sort","articles","payload","links","loadMore","replace","data","hero","newArticle","location","pathname","clear","Array","fill","currentCategory","getBy","join","Page","ArticleSubscription","currentSubscriptionState","subscription","notifyEmail","session","preferences","notifyTooltip","saveSubscription","indexOf","BlogItem","near","found","loadBlogItem","split","includedPosts","included","articleId","b","stream","PostStreamState","goToNumber","current","lastReadPostNumber","postItems","fullTime","fontSize","marginRight","opacity","articleItems","PostStream","onPositionChange","positionChanged","matches","startNumber","endNumber","BlogMeta","mixin","Model","hasOne","extendTagOverview","extend","TagsPage","markup","knowledgeBaseTags","tag_tiles","children","tile","remove","original_discussion_route","shouldRedirect","blogTags","ComposerPreview","oncreate","s9e","TextFormatter","preview","dom","Composer","previewContent","hasContent","TextEditor","submitLabel","jumpToPreview","ComposerBody","BlogComposer","articleLanguage","tagList","isArray","foundTag","isSaving","openTagsModal","selectedTags","openNameArticleModal","openBlogSettings","pageItems","articleWrapperItems","cursor","originalContent","alert","addSidebarNav","OverrideModalState","modalList","closeTimeout","componentClass","keepLast","console","clearTimeout","sync","close","$","one","currentModalPosition","splice","body","addClass","isModalOpen","initializers","routes","blog","path","blogCategory","blogComposer","blogArticle","models","Discussion","Tag","isBlog","currentTag","tagRedirectEnabled","override","DiscussionPage","original","discussionRouting","ModalManager","modal-key","animateShow","animateHide","modalShown","readyCallback","dismissible","isDismissible","hasClass","backdrop","keyboard","assign"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 51);\n","module.exports = flarum.core.compat['forum/app'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/utils/ItemList'];","module.exports = flarum.core.compat['common/Component'];","module.exports = flarum.core.compat['common/components/Link'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/components/Switch'];","module.exports = flarum.core.compat['common/helpers/icon'];","module.exports = flarum.core.compat['common/Model'];","module.exports = flarum.core.compat['common/components/Modal'];","module.exports = flarum.core.compat['common/utils/classList'];","module.exports = flarum.core.compat['common/components/Alert'];","module.exports = flarum.core.compat['forum/components/IndexPage'];","module.exports = flarum.core.compat['common/utils/Stream'];","module.exports = flarum.core.compat['common/components/Page'];","module.exports = flarum.core.compat['common/components/Tooltip'];","module.exports = flarum.core.compat['components/IndexPage'];","module.exports = flarum.core.compat['tags/components/TagDiscussionModal'];","module.exports = flarum.core.compat['common/components/Dropdown'];","module.exports = flarum.core.compat['common/utils/extractText'];","module.exports = flarum.core.compat['common/helpers/listItems'];","module.exports = flarum.core.compat['common/helpers/humanTime'];","module.exports = flarum.core.compat['forum/utils/DiscussionControls'];","module.exports = flarum.core.compat['forum/components/ModalManager'];","module.exports = require(\"regenerator-runtime\");\n","module.exports = flarum.core.compat['forum/components/CommentPost'];","module.exports = flarum.core.compat['forum/components/PostStream'];","module.exports = flarum.core.compat['forum/states/PostStreamState'];","module.exports = flarum.core.compat['forum/components/EditPostComposer'];","module.exports = flarum.core.compat['common/helpers/avatar'];","module.exports = flarum.core.compat['common/components/SelectDropdown'];","module.exports = flarum.core.compat['common/helpers/fullTime'];","module.exports = flarum.core.compat['tags/models/Tag'];","module.exports = flarum.core.compat['common/models/Discussion'];","module.exports = flarum.core.compat['forum/components/DiscussionPage'];","module.exports = flarum.core.compat['common/utils/mixin'];","module.exports = flarum.core.compat['tags/components/TagsPage'];","module.exports = flarum.core.compat['forum/components/ComposerBody'];","module.exports = flarum.core.compat['common/components/TextEditor'];","module.exports = flarum.core;","module.exports = flarum.core.compat['common/components/LinkButton'];","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","module.exports = flarum.extensions['fof-upload'];","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","/**\n * Asynchronously select file(s).\n *\n * @param contentType The content type of files you wish to select. For instance, use \"image/*\" to select all types of images.\n * @param multiple Indicates if the user can select multiple files.\n * @returns A promise of a file or array of files in case the multiple parameter is true.\n */\nfunction selectFiles(contentType: string, multiple: false): Promise<File>;\nfunction selectFiles(contentType: string, multiple: true): Promise<File[]>;\n\nfunction selectFiles(\n  contentType: string,\n  multiple: boolean\n): Promise<File | File[]> {\n  return new Promise((resolve) => {\n    let input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.multiple = multiple;\n    input.accept = contentType;\n\n    input.onchange = (_) => {\n      let files = Array.from(input.files || []);\n      if (multiple) resolve(files);\n      else resolve(files[0]);\n    };\n\n    input.click();\n  });\n}\n\nexport default selectFiles;\n","import app from \"flarum/forum/app\";\nimport Modal from \"flarum/common/components/Modal\";\nimport Button from \"flarum/common/components/Button\";\nimport ItemList from \"flarum/common/utils/ItemList\";\nimport Stream from \"flarum/common/utils/Stream\";\nimport Switch from \"flarum/common/components/Switch\";\nimport selectFiles from \"../../utils/selectFiles\";\n\nexport default class BlogPostSettingsModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    if (this.attrs.article) {\n      this.meta =\n        this.attrs.article && this.attrs.article.blogMeta()\n          ? this.attrs.article.blogMeta()\n          : app.store.createRecord(\"blogMeta\");\n    } else {\n      this.meta = this.attrs.meta\n        ? this.attrs.meta\n        : app.store.createRecord(\"blogMeta\");\n    }\n\n    this.isNew = !this.meta.exists;\n\n    this.summary = Stream(this.meta.summary() || \"\");\n\n    this.featuredImage = Stream(this.meta.featuredImage() || \"\");\n\n    this.isFeatured = Stream(this.meta.isFeatured() || false);\n    this.isSized = Stream(this.meta.isSized() || false);\n    this.isPendingReview = Stream(this.meta.isPendingReview() || false);\n  }\n\n  className() {\n    return \"Modal--small Support-Modal\";\n  }\n\n  title() {\n    return \"Blog post settings\";\n  }\n\n  content() {\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form\">{this.fields().toArray()}</div>\n      </div>\n    );\n  }\n\n  fields() {\n    const items = new ItemList();\n\n    items.add(\n      \"summary\",\n      <div className=\"Form-group\">\n        <label>Article summary:</label>\n        <textarea\n          className=\"FormControl\"\n          style={{\n            maxWidth: \"100%\",\n            minWidth: \"100%\",\n            width: \"100%\",\n            minHeight: \"120px\",\n          }}\n          bidi={this.summary}\n          placeholder={\"Please enter a summary\"}\n        />\n\n        <small>\n          This summary will be visible on the blog overview page and will be\n          used for SEO purposes.\n        </small>\n      </div>,\n      30\n    );\n\n    let fofUploadButton = null;\n\n    if (\n      \"fof-upload\" in flarum.extensions &&\n      app.forum.attribute(\"fof-upload.canUpload\")\n    ) {\n      const {\n        components: { Uploader, FileManagerModal },\n      } = require(\"@fof-upload\");\n\n      const uploader = new Uploader();\n\n      fofUploadButton = (\n        <Button\n          class=\"Button Button--icon\"\n          onclick={async () => {\n            app.modal.show(\n              FileManagerModal,\n              {\n                uploader: uploader,\n                onSelect: (files) => {\n                  const file = app.store.getById(\"files\", files[0]);\n\n                  this.featuredImage(file.url());\n                },\n              },\n              true\n            );\n          }}\n          icon=\"fas fa-cloud-upload-alt\"\n        />\n      );\n    }\n\n    items.add(\n      \"image\",\n      <div className=\"Form-group V17Blog-ArticleImage\">\n        <label>Article image URL:</label>\n        <div data-upload-enabled={!!fofUploadButton}>\n          <input\n            type=\"text\"\n            className=\"FormControl\"\n            bidi={this.featuredImage}\n            placeholder=\"https://\"\n          />\n          {fofUploadButton}\n        </div>\n\n        <small>Best image resolution for social media: 1200x630</small>\n\n        {this.featuredImage() !== \"\" && (\n          <img\n            src={this.featuredImage()}\n            alt=\"Article image\"\n            title=\"Blog post image\"\n            style={{ width: \"100%\", marginTop: \"15px\" }}\n          />\n        )}\n      </div>,\n      30\n    );\n\n    items.add(\n      \"sized\",\n      <div className=\"Form-group\">\n        {Switch.component(\n          {\n            state: this.isSized() == true,\n            onchange: (val) => {\n              this.isSized(val);\n            },\n          },\n          [\n            <b>Highlighted post</b>,\n            <div className=\"helpText\" style={{ fontWeight: 500 }}>\n              Give this post a big image on the blog overview page.\n            </div>,\n          ]\n        )}\n      </div>,\n      -10\n    );\n\n    items.add(\n      \"submit\",\n      <div className=\"Form-group\">\n        {Button.component(\n          {\n            type: \"submit\",\n            className: \"Button Button--primary SupportModal-save\",\n            loading: this.loading,\n          },\n          \"Update\"\n        )}\n      </div>,\n      -10\n    );\n\n    return items;\n  }\n\n  submitData() {\n    return {\n      summary: this.summary(),\n      featuredImage: this.featuredImage(),\n      isFeatured: this.isFeatured(),\n      isSized: this.isSized(),\n      isPendingReview: this.isPendingReview(),\n      relationships:\n        this.isNew && !this.attrs.isComposer\n          ? {\n              discussion: this.attrs.article,\n            }\n          : null,\n    };\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    // Submit data\n    if (this.attrs.onsubmit) {\n      // Update attributes\n      this.meta.pushData({\n        attributes: this.submitData(),\n      });\n\n      // Push\n      this.attrs.onsubmit(this.meta);\n\n      this.hide();\n      return;\n    }\n\n    this.loading = true;\n\n    this.meta.save(this.submitData()).then(\n      () => {\n        if (this.attrs.article) {\n          this.attrs.article.pushData({\n            relationships: {\n              blogMeta: this.meta,\n            },\n          });\n        }\n\n        this.hide();\n        m.redraw();\n      },\n      (response) => {\n        this.loading = false;\n        this.handleErrors(response);\n      }\n    );\n  }\n}\n","import Modal from \"flarum/common/components/Modal\";\nimport Button from \"flarum/common/components/Button\";\nimport ItemList from \"flarum/common/utils/ItemList\";\nimport Stream from \"flarum/common/utils/Stream\";\n\nexport default class RenameArticleModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.article = this.attrs.article;\n\n    this.name = Stream(this.article.title() || \"\");\n\n    this.redirect = this.attrs.redirect;\n  }\n\n  className() {\n    return \"Modal--small Support-Modal\";\n  }\n\n  title() {\n    return app.translator.trans(\n      \"v17development-flarum-blog.forum.tools.rename_article\"\n    );\n  }\n\n  content() {\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form\">{this.fields().toArray()}</div>\n      </div>\n    );\n  }\n\n  fields() {\n    const items = new ItemList();\n\n    items.add(\n      \"name\",\n      <div className=\"Form-group\">\n        <label>\n          {app.translator.trans(\n            \"v17development-flarum-blog.forum.article.title\"\n          )}\n          :\n        </label>\n        <input\n          className=\"FormControl\"\n          placeholder={app.translator.trans(\n            \"v17development-flarum-blog.forum.article.title\"\n          )}\n          bidi={this.name}\n        />\n      </div>,\n      50\n    );\n\n    items.add(\n      \"submit\",\n      <div className=\"Form-group\">\n        {Button.component(\n          {\n            type: \"submit\",\n            className: \"Button Button--primary SupportModal-save\",\n            loading: this.loading,\n          },\n          \"Update\"\n        )}\n      </div>,\n      -10\n    );\n\n    return items;\n  }\n\n  submitData() {\n    return {\n      title: this.name(),\n    };\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    this.loading = true;\n\n    // Do not save\n    if (this.attrs.onChange) {\n      this.attrs.onChange(this.name());\n      this.hide();\n\n      return;\n    }\n\n    this.article\n      .save({\n        title: this.name(),\n      })\n      .then(\n        () => {\n          this.hide();\n\n          // Redirect\n          if (this.redirect) {\n            const url = `/blog/${this.article.slug()}`;\n\n            m.route.set(url, true);\n            window.history.replaceState(null, document.title, url);\n          }\n        },\n        (response) => {\n          this.loading = false;\n          this.handleErrors(response);\n        }\n      );\n  }\n}\n","import Component from \"flarum/common/Component\";\nimport TagDiscussionModal from \"flarum/tags/components/TagDiscussionModal\";\nimport DiscussionControls from \"flarum/forum/utils/DiscussionControls\";\nimport Alert from \"flarum/common/components/Alert\";\nimport Button from \"flarum/common/components/Button\";\nimport Dropdown from \"flarum/common/components/Dropdown\";\nimport BlogPostSettingsModal from \"./Modals/BlogPostSettingsModal\";\nimport EditPostComposer from \"flarum/forum/components/EditPostComposer\";\nimport extractText from \"flarum/common/utils/extractText\";\nimport ItemList from \"flarum/common/utils/ItemList\";\nimport RenameArticleModal from \"./Modals/RenameArticleModal\";\nimport app from \"flarum/forum/app\";\n\nexport default class BlogPostController extends Component {\n  init() {\n    this.loadedPost = false;\n  }\n\n  manageArticleButtons() {\n    const article = this.attrs.article;\n    const items = new ItemList();\n\n    // Working for GlowingBlue version\n    const LanguageDiscussionModal =\n      flarum.extensions[\"fof-discussion-language\"] &&\n      typeof flarum.extensions[\"fof-discussion-language\"].components !==\n        \"undefined\"\n        ? flarum.extensions[\"fof-discussion-language\"].components\n            .LanguageDiscussionModal\n        : null;\n\n    // Rename article\n    if (article.canRename()) {\n      items.add(\n        \"rename\",\n        Button.component(\n          {\n            className: \"Button\",\n            onclick: () => app.modal.show(RenameArticleModal, { article }),\n            icon: \"fas fa-pencil-alt\",\n          },\n          app.translator.trans(\n            \"v17development-flarum-blog.forum.tools.rename_article\"\n          )\n        ),\n        100\n      );\n    }\n\n    const articlePost = article.firstPost();\n\n    // Edit article\n    items.add(\n      \"edit\",\n      Button.component(\n        {\n          className: \"Button\",\n          disabled: !articlePost || !articlePost.canEdit(),\n          onclick: () => {\n            app.composer.load(EditPostComposer, { post: articlePost });\n            app.composer.show();\n          },\n          icon: \"fas fa-edit\",\n        },\n        app.translator.trans(\n          \"v17development-flarum-blog.forum.tools.edit_article\"\n        )\n      ),\n      90\n    );\n\n    // Article settings\n    items.add(\n      \"articleSettings\",\n      Button.component(\n        {\n          className: \"Button\",\n          onclick: () => app.modal.show(BlogPostSettingsModal, { article }),\n          icon: \"fas fa-cogs\",\n        },\n        app.translator.trans(\n          \"v17development-flarum-blog.forum.tools.article_settings\"\n        )\n      ),\n      80\n    );\n\n    // Update categories\n    if (article.canTag()) {\n      items.add(\n        \"tag\",\n        Button.component(\n          {\n            className: \"Button\",\n            onclick: () =>\n              app.modal.show(TagDiscussionModal, { discussion: article }),\n            icon: \"fas fa-tag\",\n          },\n          app.translator.trans(\n            \"v17development-flarum-blog.forum.tools.update_category\"\n          )\n        ),\n        70\n      );\n    }\n\n    // Approve article\n    if (article.blogMeta() && article.blogMeta().isPendingReview()) {\n      items.add(\"separator1\", <li className=\"Dropdown-separator\" />, 65);\n\n      items.add(\n        \"approve\",\n        Button.component(\n          {\n            className: \"Button\",\n            disabled: !app.forum.attribute(\"canApproveBlogPosts\"),\n            onclick: () => {\n              article\n                .blogMeta()\n                .save({\n                  isPendingReview: false,\n                })\n                .then(\n                  () => {\n                    app.alerts.show(\n                      Alert,\n                      { type: \"success\" },\n                      app.translator.trans(\n                        \"v17development-flarum-blog.forum.review_article.approve_article_approved\"\n                      )\n                    );\n                  },\n                  (response) => {\n                    this.loading = false;\n                    this.handleErrors(response);\n                  }\n                );\n            },\n            icon: \"fas fa-thumbs-up\",\n          },\n          app.translator.trans(\n            \"v17development-flarum-blog.forum.review_article.approve_article\"\n          )\n        ),\n        60\n      );\n    }\n\n    // Language\n    if (\n      article.canChangeLanguage &&\n      article.canChangeLanguage() &&\n      LanguageDiscussionModal\n    ) {\n      items.add(\n        \"lang\",\n        Button.component(\n          {\n            icon: \"fas fa-globe\",\n            onclick: () =>\n              app.modal.show(LanguageDiscussionModal, { discussion: article }),\n          },\n          app.translator.trans(\n            \"fof-discussion-language.forum.discussion_controls.change_language_button\"\n          )\n        ),\n        50\n      );\n    }\n\n    items.add(\"separator2\", <li className=\"Dropdown-separator\" />, 40);\n\n    // Lock article\n    if (article.canLock()) {\n      items.add(\n        \"lock\",\n        Button.component(\n          {\n            className: \"Button\",\n            onclick: DiscussionControls.lockAction.bind(article),\n            icon: `fas ${\n              article.isLocked() ? \"fa-comments\" : \"fa-comment-slash\"\n            }`,\n          },\n          article.isLocked()\n            ? app.translator.trans(\n                \"v17development-flarum-blog.forum.tools.enable_comments\"\n              )\n            : app.translator.trans(\n                \"v17development-flarum-blog.forum.tools.disable_comments\"\n              )\n        ),\n        30\n      );\n    }\n\n    // Hide/show/delete\n    if (article.canHide()) {\n      // Article is hidden\n      if (article.isHidden()) {\n        // Recover article\n        items.add(\n          \"recover\",\n          Button.component(\n            {\n              className: \"Button\",\n              onclick: DiscussionControls.restoreAction.bind(article),\n              icon: \"fas fa-eye\",\n            },\n            app.translator.trans(\n              \"v17development-flarum-blog.forum.tools.recover_article\"\n            )\n          ),\n          20\n        );\n\n        // Delete article\n        if (article.canDelete()) {\n          buttons.add(\n            \"delete\",\n            Button.component(\n              {\n                className: \"Button\",\n                onclick: () => {\n                  // Confirm deletion\n                  if (\n                    confirm(\n                      extractText(\n                        app.translator.trans(\n                          \"core.forum.discussion_controls.delete_confirmation\"\n                        )\n                      )\n                    )\n                  ) {\n                    // Redirect if the current page is an blog article\n                    if (app.history.getCurrent().name === \"blogArticle\") {\n                      if (app.previous) {\n                        app.history.back();\n                      } else {\n                        m.route.set(app.route(\"blog\"));\n                      }\n                    }\n\n                    return article.delete().then(() => {\n                      m.redraw();\n                    });\n                  }\n                },\n                icon: \"far fa-trash-alt\",\n              },\n              app.translator.trans(\n                \"v17development-flarum-blog.forum.tools.delete_forever\"\n              )\n            ),\n            10\n          );\n        }\n      } else {\n        // Hide article\n        items.add(\n          \"hide\",\n          Button.component(\n            {\n              className: \"Button\",\n              onclick: DiscussionControls.hideAction.bind(article),\n              icon: \"fas fa-eye-slash\",\n            },\n            app.translator.trans(\n              \"v17development-flarum-blog.forum.tools.hide_article\"\n            )\n          ),\n          0\n        );\n      }\n    }\n\n    return items;\n  }\n\n  view() {\n    const article = this.attrs.article;\n\n    const articlePost = article.firstPost();\n\n    return (\n      <div className={\"FlarumBlog-Article-Content-Edit-Button\"}>\n        <div className={\"FlarumBlog-Article-Content-Edit-Dropdown\"}>\n          {Dropdown.component(\n            {\n              icon: \"fas fa-cog\",\n              label: \"Manage\",\n              buttonClassName: \"Button\",\n              menuClassName: \"Dropdown-menu--right\",\n              onshow: () => {\n                // Get post data to make sure they can edit the post\n                if (articlePost && !articlePost.canEdit() && !this.loadedPost) {\n                  this.loadedPost = true;\n                  m.redraw();\n                }\n              },\n            },\n            this.manageArticleButtons().toArray()\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","import Component from \"flarum/common/Component\";\nimport ItemList from \"flarum/common/utils/ItemList\";\nimport listItems from \"flarum/common/helpers/listItems\";\nimport avatar from \"flarum/common/helpers/avatar\";\nimport Link from \"flarum/common/components/Link\";\n\nexport default class BlogAuthor extends Component {\n  view() {\n    const author = !this.attrs.loading\n      ? this.attrs.article\n        ? this.attrs.article.user()\n        : this.attrs.user\n      : null;\n\n    return (\n      <div className={\"FlarumBlog-Article-Author\"}>\n        <div\n          className={`FlarumBlog-Article-Author-background ${\n            this.attrs.loading ? \"FlarumBlog-Author-Ghost\" : \"\"\n          }`}\n          style={{\n            backgroundColor: author && author.color() ? author.color() : null,\n          }}\n        />\n\n        <div className={\"FlarumBlog-Article-Author-Avatar\"}>\n          {author ? (\n            <Link href={app.route(\"user\", { username: author.username() })}>\n              {avatar(author)}\n            </Link>\n          ) : (\n            <span className={\"Avatar FlarumBlog-Author-Ghost\"} />\n          )}\n        </div>\n\n        {author && (\n          <div className={\"FlarumBlog-Article-Author-Info\"}>\n            <Link\n              href={app.route(\"user\", { username: author.username() })}\n              className={\"FlarumBlog-Article-Author-Name\"}\n            >\n              {author.displayName()}\n            </Link>\n            <p className={\"FlarumBlog-Article-Author-Bio\"}>\n              {author.bio && author.bio()}\n            </p>\n\n            <ul className={\"FlarumBlog-Article-Author-Extended\"}>\n              {listItems(this.items().toArray())}\n            </ul>\n          </div>\n        )}\n\n        {this.attrs.loading && (\n          <div>\n            <span\n              className={\n                \"FlarumBlog-Article-Author-Name FlarumBlog-Author-Ghost\"\n              }\n            >\n              &nbsp;\n            </span>\n            <p\n              className={\n                \"FlarumBlog-Article-Author-Bio FlarumBlog-Author-Ghost\"\n              }\n            >\n              &nbsp;\n            </p>\n            <p\n              className={\n                \"FlarumBlog-Article-Author-Bio FlarumBlog-Author-Ghost\"\n              }\n            >\n              &nbsp;\n            </p>\n            <p\n              className={\n                \"FlarumBlog-Article-Author-Bio FlarumBlog-Author-Ghost\"\n              }\n            >\n              &nbsp;\n            </p>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  items() {\n    return new ItemList();\n  }\n}\n","import Component from \"flarum/common/Component\";\nimport Link from \"flarum/common/components/Link\";\n\nexport default class BlogCategories extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.blogCategories = app.forum.attribute(\"blogTags\");\n  }\n\n  view() {\n    return (\n      <div className=\"BlogCategories BlogSideWidget\">\n        <h3>\n          {app.translator.trans(\"v17development-flarum-blog.forum.categories\")}\n        </h3>\n\n        {this.blogCategories &&\n          this.blogCategories.map((tagId) => {\n            const tag = app.store.getById(\"tags\", tagId);\n\n            if (!tag) return null;\n\n            const tags = [];\n            let showSubTags =\n              this.blogCategories.length === 1 ||\n              tag.slug() === m.route.param(\"slug\");\n\n            // Add tags\n            app.store.all(\"tags\").forEach((_tag) => {\n              if (_tag.isChild() && _tag.parent() === tag) {\n                if (_tag.slug() === m.route.param(\"slug\")) {\n                  showSubTags = true;\n                }\n\n                tags.push(this.categoryItem(_tag));\n              }\n            });\n\n            return showSubTags\n              ? [this.categoryItem(tag), ...tags]\n              : this.categoryItem(tag);\n          })}\n      </div>\n    );\n  }\n\n  // Category item\n  categoryItem(tag) {\n    return (\n      <Link\n        href={app.route(\"blogCategory\", { slug: tag.slug() })}\n        className={`BlogSideWidget-item BlogSideWidget-item-${tag.id()} ${\n          tag.isChild() && app.forum.attribute(\"blogCategoryHierarchy\") == true\n            ? \"BlogSideWidget-item-child\"\n            : \"\"\n        }`}\n      >\n        <span\n          className={tag.icon() === \"\" ? \"BlogSideWidget-item-colored\" : \"\"}\n          style={{ backgroundColor: tag.icon() === \"\" ? tag.color() : null }}\n        >\n          <i className={tag.icon()} />\n        </span>\n        {tag.name()}\n      </Link>\n    );\n  }\n}\n","import Component from \"flarum/common/Component\";\nimport IndexPage from \"flarum/forum/components/IndexPage\";\nimport SelectDropdown from \"flarum/common/components/SelectDropdown\";\n\nexport default class ForumNav extends Component {\n  view() {\n    return (\n      <div className=\"BlogForumNav BlogSideWidget\">\n        <h3>\n          {app.translator.trans(\"v17development-flarum-blog.forum.forum_nav\")}\n        </h3>\n        <nav className=\"IndexPage-nav sideNav\">\n          <SelectDropdown buttonClassName=\"Button\" className=\"App-titleControl\">\n            {this.navItems().toArray()}\n          </SelectDropdown>\n        </nav>\n      </div>\n    );\n  }\n\n  navItems() {\n    return IndexPage.prototype.navItems();\n  }\n}\n","import Component from \"flarum/common/Component\";\nimport ItemList from \"flarum/common/utils/ItemList\";\nimport listItems from \"flarum/common/helpers/listItems\";\nimport BlogAuthor from \"./BlogAuthor\";\nimport BlogCategories from \"../BlogCategories\";\nimport ForumNav from \"../ForumNav\";\n\nexport default class BlogItemSidebar extends Component {\n  view() {\n    return (\n      <div className={\"FlarumBlog-Article-Sidebar\"}>\n        <ul>{listItems(this.items().toArray())}</ul>\n      </div>\n    );\n  }\n\n  items() {\n    const itemlist = new ItemList();\n\n    itemlist.add(\"author\", BlogAuthor.component(this.attrs), 0);\n\n    itemlist.add(\"categories\", BlogCategories.component(this.attrs), 0);\n\n    itemlist.add(\"nav\", ForumNav.component(this.attrs), 0);\n\n    return itemlist;\n  }\n}\n","import Component from \"flarum/common/Component\";\n\nexport default class Language extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.languages = app.store.all(\"discussion-languages\");\n    this.options = this.languages.reduce((o, lang) => {\n      o[lang.code()] = (\n        <span>\n          <i className={\"fas fa-globe\"} /> {lang.name()}\n        </span>\n      );\n\n      return o;\n    }, this.attrs.extra || {});\n  }\n\n  view() {\n    const { language, uppercase } = this.attrs;\n    const name = language.name() || \"\";\n\n    return (\n      <span>\n        <i className={\"fas fa-globe\"} />\n        &nbsp;\n        {uppercase ? name.toUpperCase() : name}\n      </span>\n    );\n  }\n}\n","import Component from \"flarum/common/Component\";\nimport Dropdown from \"flarum/common/components/Dropdown\";\nimport Button from \"flarum/common/components/Button\";\nimport Language from \"./Language\";\n\nexport default class LanguageDropdown extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.languages = app.store.all(\"discussion-languages\");\n    this.options = this.languages.reduce((o, lang) => {\n      o[lang.code()] = <Language language={lang} />;\n\n      return o;\n    }, this.attrs.extra || {});\n  }\n\n  view() {\n    const selected = this.attrs.selected;\n\n    return Dropdown.component(\n      {\n        buttonClassName: \"Button\",\n        label: this.options[selected] || this.options[this.attrs.default],\n      },\n      Object.keys(this.options).map((key) => {\n        let defaultSelected;\n        if (\n          app.forum.attribute(\"fof-discussion-language.composerLocaleDefault\")\n        ) {\n          defaultSelected = \"any\";\n        } else {\n          defaultSelected = app.translator.formatter.locale;\n        }\n        const isSelected = selected || defaultSelected;\n        const active = key === isSelected;\n\n        return Button.component(\n          {\n            active,\n            icon: active ? \"fas fa-check\" : true,\n            onclick: () => this.attrs.onclick(key),\n          },\n          this.options[key]\n        );\n      })\n    );\n  }\n}\n","import Component from \"flarum/common/Component\";\nimport Link from \"flarum/common/components/Link\";\nimport Tooltip from \"flarum/common/components/Tooltip\";\nimport humanTime from \"flarum/common/helpers/humanTime\";\nimport icon from \"flarum/common/helpers/icon\";\nimport Discussion from \"flarum/common/models/Discussion\";\nimport classList from \"flarum/common/utils/classList\";\nimport ItemList from \"flarum/common/utils/ItemList\";\nimport app from \"flarum/forum/app\";\nimport type Mithril from \"mithril\";\n\ninterface Attrs {\n  article: Discussion;\n  defaultImage: string;\n}\n\nexport default class BlogOverviewItem extends Component<Attrs> {\n  titleItems(): ItemList<Mithril.Children> {\n    const { article } = this.attrs;\n\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\"title\", <>{article.title()}</>, 100);\n\n    if (article.blogMeta()?.isPendingReview?.() || article.isHidden()) {\n      items.add(\n        \"hidden\",\n        icon(\"fas fa-eye-slash\", { class: \"BlogList-item-hidden\" }),\n        80\n      );\n    }\n\n    if (article.blogMeta()?.isPendingReview?.()) {\n      items.add(\n        \"pendingReview\",\n        <Tooltip\n          text={app.translator.trans(\n            \"v17development-flarum-blog.forum.review_article.pending_review\"\n          )}\n        >\n          {icon(\"far fa-clock\", { class: \"BlogList-item-pendingReview\" })}\n        </Tooltip>,\n        40\n      );\n    }\n\n    return items;\n  }\n\n  dataItems(): ItemList<Mithril.Children> {\n    const { article } = this.attrs;\n\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      \"createdAt\",\n      <span class=\"BlogList-item-details-createdAt\">\n        {icon(\"far fa-clock\")} {humanTime(article.createdAt())}\n      </span>,\n      100\n    );\n\n    items.add(\n      \"author\",\n      <span class=\"BlogList-item-details-author\">\n        {icon(\"far fa-user\")}{\" \"}\n        {article.user()?.displayName?.() ||\n          app.translator.trans(\"core.lib.username.deleted_text\")}\n      </span>,\n      80\n    );\n\n    items.add(\n      \"replies\",\n      <span class=\"BlogList-item-details-replies\">\n        {icon(\"far fa-comment\")} {(article.commentCount() || 1) - 1}\n      </span>,\n      60\n    );\n\n    return items;\n  }\n\n  contentItems(): ItemList<Mithril.Children> {\n    const { article } = this.attrs;\n    const summary = article.blogMeta()?.summary?.() || \"\";\n\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\"title\", <h4>{this.titleItems().toArray()}</h4>, 100);\n\n    if (summary) items.add(\"summary\", <p>{summary}</p>, 80);\n\n    items.add(\"data\", <div class=\"data\">{this.dataItems().toArray()}</div>, 60);\n\n    return items;\n  }\n\n  getImage(): string {\n    const { article, defaultImage } = this.attrs;\n\n    return article.blogMeta()?.featuredImage?.()\n      ? `url(${article.blogMeta().featuredImage()})`\n      : defaultImage;\n  }\n\n  view(vnode: Mithril.Vnode<Attrs, this>) {\n    const { article, defaultImage } = this.attrs;\n\n    const blogImage = this.getImage();\n\n    const isSized = article.blogMeta()?.isSized?.();\n\n    return (\n      <Link\n        href={app.route(\"blogArticle\", {\n          id: `${article.slug()}`,\n        })}\n        className={classList(\n          \"BlogList-item\",\n          {\n            \"BlogList-item-sized\": isSized,\n            \"BlogList-item-default\": !isSized,\n          },\n          article.tags().map((tag) => `BlogList-item-category-${tag.id()}`)\n        )}\n      >\n        <div\n          class={classList(\"BlogList-item-photo\", {\n            \"FlarumBlog-default-image\": blogImage === defaultImage,\n          })}\n          style={{ backgroundImage: blogImage }}\n        />\n\n        <div class=\"BlogList-item-content\">{this.contentItems().toArray()}</div>\n      </Link>\n    );\n  }\n}\n","import Component from \"flarum/common/Component\";\nimport Link from \"flarum/common/components/Link\";\nimport Tooltip from \"flarum/common/components/Tooltip\";\nimport humanTime from \"flarum/common/helpers/humanTime\";\nimport icon from \"flarum/common/helpers/icon\";\nimport Discussion from \"flarum/common/models/Discussion\";\nimport ItemList from \"flarum/common/utils/ItemList\";\nimport classList from \"flarum/common/utils/classList\";\nimport app from \"flarum/forum/app\";\nimport type Mithril from \"mithril\";\n\ninterface Attrs {\n  article: Discussion;\n  defaultImage: string;\n}\n\nexport default class FeaturedBlogItem extends Component<Attrs> {\n  topItems(): ItemList<Mithril.Children> {\n    const { article } = this.attrs;\n\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      \"tags\",\n      <span class=\"BlogFeatured-list-item-tags\">\n        {article.tags()?.map((tag) => (\n          <span class=\"dataItem\">{tag.name()}</span>\n        ))}\n      </span>,\n      100\n    );\n\n    if (article.isSticky()) {\n      items.add(\n        \"sticky\",\n        <span class=\"BlogFeatured-list-item-isSticky dataItem\">\n          {icon(\"fas fa-thumbtack\")}\n        </span>,\n        80\n      );\n    }\n\n    if (article.blogMeta()?.isPendingReview?.() || article.isHidden()) {\n      items.add(\n        \"hidden\",\n        <span class=\"BlogFeatured-list-item-isHidden dataItem\">\n          {icon(\"fas fa-eye-slash\")}\n        </span>,\n        60\n      );\n    }\n\n    if (article.blogMeta()?.isPendingReview?.()) {\n      items.add(\n        \"pendingReview\",\n        <Tooltip\n          text={app.translator.trans(\n            \"v17development-flarum-blog.forum.review_article.pending_review\"\n          )}\n          position=\"bottom\"\n        >\n          <span class=\"BlogFeatured-list-item-pendingReview dataItem\">\n            {icon(\"far fa-clock\")}{\" \"}\n            {app.translator.trans(\n              \"v17development-flarum-blog.forum.review_article.pending_review_title\"\n            )}\n          </span>\n        </Tooltip>,\n        40\n      );\n    }\n\n    return items;\n  }\n\n  dataItems(): ItemList<Mithril.Children> {\n    const { article } = this.attrs;\n\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      \"createdAt\",\n      <span class=\"BlogFeatured-list-item-details-createdAt\">\n        {icon(\"far fa-clock\")} {humanTime(article.createdAt())}\n      </span>,\n      100\n    );\n\n    items.add(\n      \"author\",\n      <span class=\"BlogFeatured-list-item-details-author\">\n        {icon(\"far fa-user\")}{\" \"}\n        {article.user()?.displayName() ||\n          app.translator.trans(\"core.lib.username.deleted_text\")}\n      </span>,\n      80\n    );\n\n    items.add(\n      \"replies\",\n      <span class=\"BlogFeatured-list-item-details-replies\">\n        {icon(\"far fa-comment\")} {article.commentCount() - 1}\n      </span>,\n      60\n    );\n\n    return items;\n  }\n\n  view(vnode: Mithril.Vnode<Attrs, this>) {\n    const { article, defaultImage } = this.attrs;\n\n    const blogImage = article.blogMeta()?.featuredImage?.()\n      ? `url(${article.blogMeta().featuredImage()})`\n      : defaultImage;\n\n    return (\n      <Link\n        href={app.route(\"blogArticle\", {\n          id: `${article.slug()}`,\n        })}\n        className={classList(\n          \"BlogFeatured-list-item\",\n          article\n            .tags()\n            .map((tag) => `BlogFeatured-list-item-category-${tag.id()}`),\n          \"FlarumBlog-default-image\"\n        )}\n        style={{ backgroundImage: blogImage }}\n      >\n        <div class=\"BlogFeatured-list-item-top\">\n          {this.topItems().toArray()}\n        </div>\n\n        <div className={\"BlogFeatured-list-item-details\"}>\n          <h4>{article.title()}</h4>\n\n          <div className={\"data\"}>{this.dataItems().toArray()}</div>\n        </div>\n      </Link>\n    );\n  }\n}\n","import app from \"flarum/forum/app\";\n\nimport IndexPage from \"flarum/components/IndexPage\";\nimport Page from \"flarum/common/components/Page\";\nimport Button from \"flarum/common/components/Button\";\nimport BlogCategories from \"../components/BlogCategories\";\nimport Link from \"flarum/common/components/Link\";\nimport LanguageDropdown from \"../components/LanguageDropdown/LanguageDropdown\";\nimport ForumNav from \"../components/ForumNav\";\nimport BlogOverviewItem from \"../components/BlogOverviewItem\";\nimport FeaturedBlogItem from \"../components/FeaturedBlogItem\";\n\nexport default class BlogOverview extends Page {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    app.setTitle(app.translator.trans(\"v17development-flarum-blog.forum.blog\"));\n\n    this.bodyClass = \"BlogOverviewPage\";\n\n    this.isLoading = true;\n    this.featuredPosts = [];\n    this.posts = [];\n    this.hasMore = null;\n    this.isLoadingMore = false;\n\n    this.languages = app.store.all(\"discussion-languages\");\n\n    this.currentSelectedLanguage = m.route.param(\"lang\")\n      ? m.route.param(\"lang\")\n      : app.translator.formatter.locale;\n\n    // Send history push\n    app.history.push(\"blog\");\n\n    this.loadBlogOverview();\n\n    this.featuredCount = parseInt(app.forum.attribute(\"blogFeaturedCount\"));\n\n    this.showCategories = true;\n    this.showForumNav = true;\n  }\n\n  // Load blog overview\n  loadBlogOverview() {\n    const preloadBlogOverview = app.preloadedApiDocument();\n\n    if (preloadBlogOverview) {\n      // We must wrap this in a setTimeout because if we are mounting this\n      // component for the first time on page load, then any calls to m.redraw\n      // will be ineffective and thus any configs (scroll code) will be run\n      // before stuff is drawn to the page.\n      setTimeout(this.show.bind(this, preloadBlogOverview), 0);\n    } else {\n      this.reloadData();\n    }\n\n    m.redraw();\n  }\n\n  reloadData() {\n    let q = `is:blog${\n      m.route.param(\"slug\") ? ` tag:${m.route.param(\"slug\")}` : \"\"\n    }`;\n\n    if (this.languages !== null && this.languages.length >= 1) {\n      q += ` language:${this.currentSelectedLanguage}`;\n    }\n\n    app.store\n      .find(\"discussions\", {\n        filter: {\n          q,\n        },\n        sort: \"-createdAt\",\n      })\n      .then(this.show.bind(this))\n      .catch(() => {\n        m.redraw();\n      });\n  }\n\n  // Show blog posts\n  show(articles) {\n    if (articles.length === 0) {\n      this.isLoading = false;\n      m.redraw();\n\n      return;\n    }\n\n    // Set pagination\n    this.hasMore =\n      articles.payload.links && articles.payload.links.next\n        ? articles.payload.links.next\n        : null;\n\n    this.featuredPosts = articles.slice(0, this.featuredCount);\n    this.posts =\n      articles.length > this.featuredCount\n        ? articles.slice(this.featuredCount, articles.length)\n        : [];\n\n    this.isLoading = false;\n\n    m.redraw();\n  }\n\n  // Load more blog posts\n  loadMore() {\n    this.isLoadingMore = true;\n\n    app.store\n      .find(this.hasMore.replace(app.forum.attribute(\"apiUrl\"), \"\"))\n      .then((data) => {\n        data.map((article) => this.posts.push(article));\n\n        // Update hasmore button\n        this.hasMore =\n          data.payload.links && data.payload.links.next\n            ? data.payload.links.next\n            : null;\n      })\n      .catch(() => {})\n      .then(() => {\n        this.isLoadingMore = false;\n        m.redraw();\n      });\n  }\n\n  title() {\n    if (!m.route.param(\"slug\")) {\n      return (\n        <h2>\n          {app.translator.trans(\n            \"v17development-flarum-blog.forum.recent_posts\"\n          )}\n        </h2>\n      );\n    }\n\n    const tag = app.store\n      .all(\"tags\")\n      .filter((tag) => tag.slug() === m.route.param(\"slug\"));\n\n    return (\n      <h2>\n        {tag && tag[0] && tag[0].name()}\n        <small>\n          {\" \"}\n          -{\" \"}\n          <Link href={app.route(\"blog\")}>\n            {app.translator.trans(\n              \"v17development-flarum-blog.forum.return_to_overview\"\n            )}\n          </Link>\n        </small>\n      </h2>\n    );\n  }\n\n  view() {\n    const defaultImage = app.forum.attribute(\"blogDefaultImage\")\n      ? `url(${\n          app.forum.attribute(\"baseUrl\") +\n          \"/assets/\" +\n          app.forum.attribute(\"blogDefaultImage\")\n        })`\n      : null;\n\n    return [\n      app.forum.attribute(\"blogAddHero\") == true && IndexPage.prototype.hero(),\n      <div className={\"FlarumBlogOverview\"}>\n        <div className={\"container\"}>\n          <div className={\"BlogFeatured\"}>\n            <div className={\"BlogOverviewButtons\"}>\n              {app.forum.attribute(\"canWriteBlogPosts\") && (\n                <Button\n                  className={\"Button\"}\n                  onclick={() => this.newArticle()}\n                  icon={\"fas fa-pencil-alt\"}\n                >\n                  {app.translator.trans(\n                    \"v17development-flarum-blog.forum.compose.write_article\"\n                  )}\n                </Button>\n              )}\n\n              {this.languages !== null && this.languages.length >= 1 && (\n                <LanguageDropdown\n                  selected={this.currentSelectedLanguage}\n                  onclick={(language) => {\n                    this.currentSelectedLanguage = language;\n\n                    m.route.set(document.location.pathname, {\n                      lang: language,\n                    });\n\n                    this.reloadData();\n                  }}\n                />\n              )}\n            </div>\n\n            {this.title()}\n\n            <div style={{ clear: \"both\" }} />\n\n            <div class=\"BlogFeatured-list\">\n              {/* Ghost data */}\n              {this.isLoading &&\n                [...new Array(this.featuredCount).fill(undefined)].map(() => (\n                  <div class=\"BlogFeatured-list-item BlogFeatured-list-item-ghost\">\n                    <div class=\"BlogFeatured-list-item-details\">\n                      <h4>&nbsp;</h4>\n\n                      <div class=\"data\">\n                        <span>\n                          <i class=\"far fa-wave\" />\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n\n              {!this.isLoading &&\n                this.featuredPosts.length >= 0 &&\n                this.featuredPosts.map((article) => (\n                  <FeaturedBlogItem\n                    article={article}\n                    defaultImage={defaultImage}\n                  />\n                ))}\n            </div>\n          </div>\n\n          <div className={\"BlogScrubber\"}>\n            <div className={\"BlogList\"}>\n              {this.isLoading &&\n                [false, false, true, false].map((state) => {\n                  return (\n                    <div\n                      className={`BlogList-item BlogList-item-${\n                        state === true ? \"sized\" : \"default\"\n                      } BlogList-item-ghost`}\n                    >\n                      <div\n                        className={\n                          \"BlogList-item-photo FlarumBlog-default-image\"\n                        }\n                      ></div>\n                      <div className={\"BlogList-item-content\"}>\n                        <h4>&nbsp;</h4>\n                        <p>&nbsp;</p>\n\n                        <div className={\"data\"}>\n                          <span>\n                            <i className={\"far fa-wave\"} />\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })}\n\n              {!this.isLoading &&\n                this.posts.length >= 1 &&\n                this.posts.map((article) => (\n                  <BlogOverviewItem\n                    article={article}\n                    defaultImage={defaultImage}\n                  />\n                ))}\n\n              {!this.isLoading &&\n                this.featuredPosts.length > 0 &&\n                this.hasMore === null && (\n                  <p className={\"FlarumBlog-reached-end\"}>\n                    {app.translator.trans(\n                      \"v17development-flarum-blog.forum.no_more_posts\"\n                    )}\n                  </p>\n                )}\n\n              {!this.isLoading &&\n                this.featuredPosts.length === 0 &&\n                this.posts.length === 0 && (\n                  <p className={\"FlarumBlog-reached-end\"}>\n                    {app.translator.trans(\n                      \"v17development-flarum-blog.forum.category_empty\"\n                    )}\n                  </p>\n                )}\n\n              {!this.isLoading && this.hasMore !== null && (\n                <div className={\"FlarumBlog-reached-load-more\"}>\n                  <Button\n                    className={\"Button\"}\n                    onclick={() => this.loadMore()}\n                    icon={\"fas fa-chevron-down\"}\n                    loading={this.isLoadingMore}\n                  >\n                    {app.translator.trans(\n                      \"core.forum.discussion_list.load_more_button\"\n                    )}\n                  </Button>\n                </div>\n              )}\n            </div>\n\n            <div className={\"Sidebar\"}>\n              {this.showCategories && <BlogCategories />}\n              {this.showForumNav && <ForumNav />}\n            </div>\n          </div>\n        </div>\n      </div>,\n    ];\n  }\n\n  newArticle() {\n    let tags = [];\n\n    // Get current category\n    const currentCategory = app.store.getBy(\n      \"tags\",\n      \"slug\",\n      m.route.param(\"slug\")\n    );\n\n    if (currentCategory) {\n      tags.push(currentCategory);\n    }\n\n    // Redirect to the composer\n    m.route.set(\n      app.route(\"blogComposer\", {\n        tags: tags.map((tag) => tag.id()).join(),\n        lang:\n          this.languages.length > 0 ? this.currentSelectedLanguage : undefined,\n      })\n    );\n  }\n}\n","import Component from \"flarum/common/Component\";\nimport Button from \"flarum/common/components/Button\";\nimport extractText from \"flarum/common/utils/extractText\";\nimport Tooltip from \"flarum/common/components/Tooltip\";\n\nexport default class ArticleSubscription extends Component {\n  view() {\n    const currentSubscriptionState = this.attrs.discussion.subscription();\n\n    const preferences = app.session.user.preferences();\n    const notifyEmail = preferences[\"notify_newPost_email\"];\n    const notifyTooltip = extractText(\n      app.translator.trans(\n        notifyEmail\n          ? \"flarum-subscriptions.forum.sub_controls.notify_email_tooltip\"\n          : \"flarum-subscriptions.forum.sub_controls.notify_alert_tooltip\"\n      )\n    );\n\n    let title = app.translator.trans(\n      \"flarum-subscriptions.forum.sub_controls.not_following_button\"\n    );\n    let icon = \"far fa-star\";\n\n    // Following\n    if (currentSubscriptionState === \"follow\") {\n      title = app.translator.trans(\n        \"flarum-subscriptions.forum.sub_controls.following_button\"\n      );\n      icon = \"fas fa-star\";\n    }\n\n    return (\n      <Tooltip text={notifyTooltip} position=\"bottom\">\n        <Button\n          className={`Button BlogArticleSubscription SubscriptionMenu-button--${currentSubscriptionState}`}\n          icon={icon}\n          onclick={this.saveSubscription.bind(\n            this,\n            this.attrs.discussion,\n            [\"follow\", \"ignore\"].indexOf(currentSubscriptionState) !== -1\n              ? null\n              : \"follow\"\n          )}\n        >\n          {title}\n        </Button>\n      </Tooltip>\n    );\n  }\n\n  saveSubscription(discussion, subscription) {\n    discussion.save({ subscription });\n  }\n}\n","import Page from \"flarum/common/components/Page\";\nimport IndexPage from \"flarum/components/IndexPage\";\nimport CommentPost from \"flarum/forum/components/CommentPost\";\nimport PostStream from \"flarum/forum/components/PostStream\";\nimport PostStreamState from \"flarum/forum/states/PostStreamState\";\nimport BlogPostController from \"../components/BlogPostController\";\nimport BlogItemSidebar from \"../components/BlogItemSidebar/BlogItemSidebar\";\nimport Link from \"flarum/common/components/Link\";\nimport BlogOverview from \"./BlogOverview\";\nimport fullTime from \"flarum/common/helpers/fullTime\";\nimport ArticleSubscription from \"../components/ArticleSubscription\";\nimport classList from \"flarum/common/utils/classList\";\nimport ItemList from \"flarum/common/utils/ItemList\";\nimport icon from \"flarum/common/helpers/icon\";\nimport app from \"flarum/forum/app\";\n\nexport default class BlogItem extends Page {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    app.setTitle(app.translator.trans(\"v17development-flarum-blog.forum.blog\"));\n\n    // Send history push\n    app.history.push(\"blogArticle\");\n\n    this.bodyClass = \"BlogItemPage\";\n\n    this.near = m.route.param(\"near\") || 0;\n\n    this.loading = true;\n    this.found = false;\n    this.article = null;\n\n    this.loadBlogItem();\n  }\n\n  // Load blog overview\n  loadBlogItem() {\n    const preloadBlogOverview = app.preloadedApiDocument();\n\n    if (preloadBlogOverview) {\n      // We must wrap this in a setTimeout because if we are mounting this\n      // component for the first time on page load, then any calls to m.redraw\n      // will be ineffective and thus any configs (scroll code) will be run\n      // before stuff is drawn to the page.\n      setTimeout(this.show.bind(this, preloadBlogOverview), 0);\n    } else {\n      app.store\n        .find(\"discussions\", m.route.param(\"id\").split(\"-\")[0])\n        .then(this.show.bind(this))\n        .catch(() => {\n          m.redraw();\n        });\n    }\n\n    m.redraw();\n  }\n\n  // Show blog post\n  show(article) {\n    // Set article data\n    this.article = article;\n\n    // Update title\n    app.setTitle(\n      `${article.title()} - ${app.translator.trans(\n        \"v17development-flarum-blog.forum.blog\"\n      )}`\n    );\n\n    this.loading = false;\n\n    let includedPosts = [];\n    if (article.payload && article.payload.included) {\n      const articleId = article.id();\n\n      includedPosts = article.payload.included\n        .filter(\n          (record) =>\n            record.type === \"posts\" &&\n            record.relationships &&\n            record.relationships.discussion &&\n            record.relationships.discussion.data.id === articleId\n        )\n        .map((record) => app.store.getById(\"posts\", record.id))\n        .sort((a, b) => a.id() - b.id())\n        .slice(0, 20);\n    }\n\n    this.stream = new PostStreamState(article, includedPosts);\n\n    // Scroll to specific post\n    if (this.near) {\n      this.stream.goToNumber(this.near || 0, true).then(() => {\n        app.current.set(\"discussion\", article);\n        app.current.set(\"stream\", this.stream);\n      });\n    }\n\n    // Read post on load\n    if (app.session.user && !article.lastReadPostNumber()) {\n      article.save({ lastReadPostNumber: 1 });\n    }\n\n    m.redraw();\n  }\n\n  postItems() {\n    let articlePost = null;\n\n    if (!this.loading && this.article) {\n      articlePost = this.article?.firstPost?.();\n    }\n\n    const items = new ItemList();\n\n    items.add(\n      \"title\",\n      <h3\n        className={classList(\"FlarumBlog-Article-Title\", {\n          \"FlarumBlog-Article-GhostTitle\": this.loading,\n        })}\n      >\n        {this?.article?.title?.() || \"Ghost title\"}\n        {this.article?.isHidden?.() &&\n          `(${app.translator.trans(\n            \"v17development-flarum-blog.forum.hidden\"\n          )})`}\n      </h3>,\n      100\n    );\n\n    items.add(\n      \"publishDate\",\n      <div\n        className={classList(\"FlarumBlog-Article-PublishDate\", {\n          \"FlarumBlog-Article-GhostPublishDate\": this.loading,\n        })}\n      >\n        {this.article ? (\n          fullTime(this.article.createdAt())\n        ) : (\n          <span>&nbsp;</span>\n        )}\n      </div>,\n      80\n    );\n\n    if (this.loading) {\n      items.add(\n        \"skeleton\",\n        [0, 1, 2].map(() => (\n          <div>\n            <p className={\"FlarumBlog-Article-GhostParagraph\"}>&nbsp;</p>\n            <p className={\"FlarumBlog-Article-GhostParagraph\"}>&nbsp;</p>\n            <p className={\"FlarumBlog-Article-GhostParagraph\"}>&nbsp;</p>\n            <p>&nbsp;</p>\n          </div>\n        )),\n        60\n      );\n    }\n\n    if (!this.loading) {\n      if (this.article.blogMeta?.()?.isPendingReview?.()) {\n        items.add(\n          \"review\",\n          <div className={\"Post-body\"}>\n            <blockquote class=\"uncited\" style={{ fontSize: \"16px\" }}>\n              <div>\n                {icon(\"far fa-clock\", { style: { marginRight: \"5px\" } })}{\" \"}\n                {app.translator.trans(\n                  \"v17development-flarum-blog.forum.review_article.pending_review\"\n                )}\n              </div>\n            </blockquote>\n          </div>,\n          60\n        );\n      }\n\n      if (articlePost) {\n        items.add(\"post\", <CommentPost post={articlePost} />, 40);\n      }\n    }\n\n    return items;\n  }\n\n  contentItems() {\n    const defaultImage = app.forum.attribute(\"blogDefaultImage\")\n      ? `url(${app.forum.attribute(\"baseUrl\")}/assets/${app.forum.attribute(\n          \"blogDefaultImage\"\n        )})`\n      : null;\n\n    const blogImage = this.article?.blogMeta()?.featuredImage?.()\n      ? `url(${this.article.blogMeta().featuredImage()})`\n      : defaultImage;\n\n    const items = new ItemList();\n\n    items.add(\n      \"image\",\n      <div\n        className={classList(\n          \"FlarumBlog-Article-Image FlarumBlog-default-image\",\n          { \"FlarumBlog-Article-GhostImage\": this.loading }\n        )}\n        style={{\n          backgroundImage: blogImage,\n          opacity: this.article?.isHidden?.() ? 0.4 : null,\n        }}\n      />,\n      100\n    );\n\n    if (\n      this.article &&\n      (app.session.user?.canEdit?.() ||\n        this.article?.canRename?.() ||\n        this.article?.posts?.()?.[0]?.canEdit?.())\n    ) {\n      items.add(\n        \"editArticle\",\n        <BlogPostController article={this.article} />,\n        80\n      );\n    }\n\n    // Article Categories\n    items.add(\n      \"categories\",\n      <div className=\"FlarumBlog-Article-Categories\">\n        {!this.loading &&\n          this.article\n            ?.tags?.()\n            ?.map((tag) => (\n              <Link href={app.route(\"blogCategory\", { slug: tag.slug() })}>\n                {tag.name()}\n              </Link>\n            ))}\n\n        {this.loading &&\n          [0, 1].map(() => (\n            <span className=\"FlarumBlog-Article-GhostCategory\">Category</span>\n          ))}\n      </div>,\n      60\n    );\n\n    items.add(\n      \"post\",\n      <div className={\"FlarumBlog-Article-Post\"}>\n        {this.postItems().toArray()}\n      </div>,\n      40\n    );\n\n    return items;\n  }\n\n  articleItems() {\n    const items = new ItemList();\n\n    items.add(\n      \"content\",\n      <div className=\"FlarumBlog-Article-Content\">\n        {this.contentItems().toArray()}\n      </div>,\n      100\n    );\n\n    if (\n      !(this?.article?.isLocked?.() && this?.article?.commentCount?.() === 1)\n    ) {\n      items.add(\n        \"comments\",\n        <div className={\"FlarumBlog-Article-Comments\"}>\n          {/* Show subscription state */}\n          {!this.loading &&\n            app.session.user &&\n            this.article.subscription &&\n            (!this.article.isLocked ||\n              (this.article.isLocked && !this.article.isLocked())) && (\n              <ArticleSubscription discussion={this.article} />\n            )}\n\n          <h4>\n            {app.translator.trans(\n              \"v17development-flarum-blog.forum.comment_section.comments\"\n            )}{\" \"}\n            ({this.article ? this.article.commentCount() - 1 : 0})\n          </h4>\n\n          {/* Locked */}\n          {!this.loading && this.article?.isLocked?.() && (\n            <div className={\"Post-body\"}>\n              <blockquote class=\"uncited\">\n                <div>\n                  <span\n                    className={\"far fa-lock\"}\n                    style={{ marginRight: \"5px\" }}\n                  />{\" \"}\n                  {app.translator.trans(\n                    \"v17development-flarum-blog.forum.comment_section.locked\"\n                  )}\n                </div>\n              </blockquote>\n            </div>\n          )}\n\n          {!this.loading &&\n            this.article &&\n            PostStream.component({\n              discussion: this.article,\n              stream: this.stream,\n              onPositionChange: this.positionChanged.bind(this),\n            })}\n        </div>,\n        75\n      );\n    }\n\n    return items;\n  }\n\n  view() {\n    return [\n      app.forum.attribute(\"blogAddHero\") == true && IndexPage.prototype.hero(),\n      <div className={\"FlarumBlogItem\"}>\n        <div className={\"container\"}>\n          <div className={\"FlarumBlog-ToolButtons\"}>\n            <Link\n              href={app.route(\"blog\")}\n              className={\"Button\"}\n              onclick={(e) => {\n                if (app.previous.matches(BlogOverview)) {\n                  e.preventDefault();\n                  history.back();\n                }\n              }}\n            >\n              <i class=\"icon fas fa-angle-left Button-icon\"></i>\n              <span class=\"Button-label\">\n                {app.translator.trans(\n                  \"v17development-flarum-blog.forum.return_to_overview\"\n                )}\n              </span>\n            </Link>\n          </div>\n          <div className={\"FlarumBlog-Article\"}>\n            <div className={\"FlarumBlog-Article-Container\"}>\n              {this.articleItems().toArray()}\n            </div>\n\n            <BlogItemSidebar article={this.article} loading={this.loading} />\n          </div>\n        </div>\n      </div>,\n    ];\n  }\n\n  positionChanged(startNumber, endNumber) {\n    const article = this.article;\n\n    if (app.session.user && endNumber > (article.lastReadPostNumber() || 0)) {\n      article.save({ lastReadPostNumber: endNumber });\n      m.redraw();\n    }\n  }\n}\n","import Model from \"flarum/common/Model\";\nimport mixin from \"flarum/common/utils/mixin\";\n\nexport default class BlogMeta extends mixin(Model, {\n  discussion: Model.hasOne(\"discussion\"),\n  featuredImage: Model.attribute(\"featuredImage\"),\n  summary: Model.attribute(\"summary\"),\n  isFeatured: Model.attribute(\"isFeatured\"),\n  isSized: Model.attribute(\"isSized\"),\n  isPendingReview: Model.attribute(\"isPendingReview\"),\n}) {}\n","import { extend } from \"flarum/common/extend\";\nimport IndexPage from \"flarum/forum/components/IndexPage\";\nimport TagsPage from \"flarum/tags/components/TagsPage\";\n\nexport default function extendTagOverview() {\n  extend(TagsPage.prototype, \"view\", function (markup) {\n    // Pending xhr to load all tags, throw back loading indicator.\n    if (this.loading) {\n      return markup;\n    }\n\n    if (app.forum.attribute(\"blogHideTags\") === false) return markup;\n\n    // Get knowledge base tag ID's\n    const knowledgeBaseTags = app.forum.attribute(\"blogTags\") || [];\n\n    // Get tiles\n    let tag_tiles = markup.children[1].children[1].children[0].children;\n\n    // Map through the tiles and remove tiles that are part of the knowledge base\n    markup.children[1].children[1].children[0].children = tag_tiles.map(\n      (tile, i) => {\n        return knowledgeBaseTags.indexOf(this.tags[i].id()) >= 0 ? null : tile;\n      }\n    );\n\n    return markup;\n  });\n\n  extend(IndexPage.prototype, \"navItems\", function (items) {\n    if (app.forum.attribute(\"blogHideTags\") === false) return items;\n\n    const blogTags = app.forum.attribute(\"blogTags\") || [];\n\n    blogTags.forEach((id) => {\n      items.remove(`tag${id}`);\n    });\n\n    return items;\n  });\n}\n","export default function () {\n  // Save the original function before we override it\n  const original_discussion_route = app.route.discussion;\n\n  /**\n   * Generate a URL to a discussion OR a Blog Article.\n   *\n   * CORE_CODE_OVERRIDE: This overrides the standard function from flarum/core.\n   * The code is inspired from js/src/forum/routes.js and now handles different types of discussions.\n   * It will try to keep the original function executed if the discussion being\n   * processed isn't a blog article.\n   *\n   * @param {Discussion} discussion\n   * @param {Integer} [near]\n   * @return {String}\n   */\n  app.route.discussion = (discussion, near) => {\n    const discussionRedirectEnabled =\n      app.forum.attribute(\"blogRedirectsEnabled\") === \"both\" ||\n      app.forum.attribute(\"blogRedirectsEnabled\") === \"discussions_only\";\n    let shouldRedirect = false;\n    if (discussionRedirectEnabled && discussion.tags().length > 0) {\n      const blogTags = app.forum.attribute(\"blogTags\");\n\n      const foundTags = discussion.tags().filter((tag) => {\n        return (\n          blogTags.indexOf(tag.id()) >= 0 ||\n          (tag.parent() && blogTags.indexOf(tag.parent().id()) >= 0)\n        );\n      });\n\n      if (foundTags.length > 0) {\n        shouldRedirect = true;\n      }\n    }\n    if (shouldRedirect) {\n      return discussion.lastReadPostNumber() > 1\n        ? app.route(\"blogArticle.near\", {\n            id: discussion.slug(),\n            near: discussion.lastReadPostNumber(),\n          })\n        : app.route(\"blogArticle\", {\n            id: discussion.slug(),\n          });\n    } else {\n      return original_discussion_route(discussion, near);\n    }\n  };\n}\n","import Component from \"flarum/common/Component\";\n\nexport default class ComposerPreview extends Component {\n  view() {\n    return <div />;\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    s9e.TextFormatter.preview(vnode.attrs.content || \"\", vnode.dom);\n  }\n}\n","import ComposerBody from \"flarum/forum/components/ComposerBody\";\nimport Button from \"flarum/common/components/Button\";\nimport TextEditor from \"flarum/common/components/TextEditor\";\nimport ComposerPreview from \"./ComposerPreview\";\nimport app from \"flarum/forum/app\";\n\nexport default class Composer extends ComposerBody {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.previewContent = false;\n  }\n\n  // Render\n  view() {\n    const hasContent =\n      this.composer.fields.content() && this.composer.fields.content() !== \"\";\n    const loading = this.loading || this.attrs.disabled;\n\n    return (\n      <div\n        className={`Flarum-Blog-Composer ${\n          loading ? \"Flarum-Blog-Composer-Loading\" : \"\"\n        }`}\n      >\n        <div className={\"Flarum-Blog-Composer-tabs\"}>\n          <Button\n            className={!this.previewContent && \"AricleComposerButtonSelected\"}\n            onclick={() => (this.previewContent = false)}\n          >\n            {app.translator.trans(\n              \"v17development-flarum-blog.forum.composer.write\"\n            )}\n          </Button>\n          <Button\n            className={this.previewContent && \"AricleComposerButtonSelected\"}\n            onclick={() => (this.previewContent = true)}\n          >\n            {app.translator.trans(\n              \"v17development-flarum-blog.forum.composer.view\"\n            )}\n          </Button>\n        </div>\n\n        <div\n          className={`Composer Flarum-Blog-Composer-body ${\n            this.previewContent ? \"Flarum-Blog-Composer-HideEditor\" : \"\"\n          }`}\n        >\n          {this.previewContent && (\n            <div className={\"Flarum-Blog-Composer-preview\"}>\n              {!hasContent &&\n                app.translator.trans(\n                  \"v17development-flarum-blog.forum.composer.nothing_to_preview\"\n                )}\n\n              <ComposerPreview content={this.composer.fields.content()} />\n            </div>\n          )}\n\n          {TextEditor.component({\n            submitLabel:\n              this.attrs.submitLabel ||\n              app.translator.trans(\"core.forum.composer_edit.submit_button\"),\n            placeholder: this.attrs.placeholder,\n            disabled: loading,\n            composer: this.composer,\n            preview: this.jumpToPreview && this.jumpToPreview.bind(this),\n            onchange: this.composer.fields.content,\n            onsubmit: this.onsubmit.bind(this),\n            value: this.composer.fields.content(),\n          })}\n        </div>\n      </div>\n    );\n  }\n\n  // Submit trigger\n  onsubmit() {\n    if (this.attrs.onsubmit) {\n      this.attrs.onsubmit();\n    }\n  }\n}\n","import app from \"flarum/forum/app\";\nimport Page from \"flarum/common/components/Page\";\nimport Button from \"flarum/common/components/Button\";\nimport Link from \"flarum/common/components/Link\";\nimport BlogAuthor from \"../components/BlogItemSidebar/BlogAuthor\";\nimport RenameArticleModal from \"../components/Modals/RenameArticleModal\";\nimport TagDiscussionModal from \"flarum/tags/components/TagDiscussionModal\";\nimport BlogPostSettingsModal from \"../components/Modals/BlogPostSettingsModal\";\nimport Composer from \"../components/Composer/Composer\";\nimport LanguageDropdown from \"../components/LanguageDropdown/LanguageDropdown\";\nimport ItemList from \"flarum/common/utils/ItemList\";\n\nexport default class BlogComposer extends Page {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    app.setTitle(app.translator.trans(\"v17development-flarum-blog.forum.blog\"));\n\n    // User cannot write blogs\n    if (!app.forum.attribute(\"canWriteBlogPosts\")) {\n      m.route.set(app.route(\"blog\"));\n      return;\n    }\n\n    // Send history push\n    app.history.push(\"blogComposer\");\n\n    // Get languages (if enabled)\n    this.languages = app.store.all(\"discussion-languages\") || [];\n\n    // Set body class\n    this.bodyClass = \"BlogItemPage BlogItemPage--composer\";\n\n    // Article data\n    this.articleLanguage = m.route.param(\"lang\")\n      ? m.route.param(\"lang\")\n      : app.translator.locale;\n    this.article = app.store.createRecord(\"discussions\");\n    this.blogMeta = null;\n\n    this.tags = [];\n\n    // Pre-select tags\n    if (m.route.param().tags) {\n      const tagList = Array.isArray(m.route.param().tags)\n        ? m.route.param().tags\n        : m.route.param().tags.split(\",\");\n\n      if (m.route.param().tags.length > 0) {\n        tagList.forEach((tagId) => {\n          const foundTag = app.store.getById(\"tags\", tagId);\n\n          if (foundTag) {\n            this.tags.push(foundTag);\n          }\n        });\n      }\n    }\n\n    this.isSaving = false;\n  }\n\n  openTagsModal(e = null) {\n    if (e) {\n      e.preventDefault();\n    }\n\n    if (this.isSaving) return;\n\n    app.modal.show(TagDiscussionModal, {\n      selectedTags: this.tags,\n      onsubmit: (tags) => {\n        this.tags = tags;\n      },\n    });\n  }\n\n  openNameArticleModal(e = null) {\n    if (e) {\n      e.preventDefault();\n    }\n\n    if (this.isSaving) return;\n\n    app.modal.show(RenameArticleModal, {\n      article: this.article,\n      onChange: (title) => {\n        this.article.pushData({\n          attributes: {\n            title,\n          },\n        });\n      },\n    });\n  }\n\n  openBlogSettings(e) {\n    e.preventDefault();\n\n    if (this.isSaving) return;\n\n    app.modal.show(BlogPostSettingsModal, {\n      meta: this.blogMeta,\n      onsubmit: (meta) => (this.blogMeta = meta),\n    });\n  }\n\n  view() {\n    return (\n      <div className={\"FlarumBlogItem\"}>\n        <div className={\"container\"}>{this.pageItems().toArray()}</div>\n      </div>\n    );\n  }\n\n  pageItems() {\n    const items = new ItemList();\n\n    items.add(\n      \"toolButtons\",\n      <div className=\"FlarumBlog-ToolButtons\">\n        <Link\n          href={app.route(\"blog\")}\n          className=\"Button\"\n          loading={this.isSaving}\n          icon=\"fas fa-angle-left\"\n        >\n          <i class=\"icon fas fa-angle-left Button-icon\" />\n          <span class=\"Button-label\">\n            {app.translator.trans(\n              \"v17development-flarum-blog.forum.return_to_overview\"\n            )}\n          </span>\n        </Link>\n      </div>,\n      100\n    );\n\n    items.add(\n      \"article\",\n      <div className={\"FlarumBlog-Article\"}>\n        {this.articleWrapperItems().toArray()}\n      </div>,\n      90\n    );\n\n    return items;\n  }\n\n  articleWrapperItems() {\n    const items = new ItemList();\n\n    items.add(\n      \"container\",\n      <div className=\"FlarumBlog-Article-Container\">\n        {this.articleItems().toArray()}\n      </div>,\n      100\n    );\n\n    items.add(\n      \"sidebar\",\n      <div className=\"FlarumBlog-Article-Sidebar\">\n        <BlogAuthor user={app.session.user} />\n      </div>,\n      90\n    );\n\n    return items;\n  }\n\n  articleItems() {\n    const items = new ItemList();\n\n    const defaultImage = app.forum.attribute(\"blogDefaultImage\")\n      ? `url(${\n          app.forum.attribute(\"baseUrl\") +\n          \"/assets/\" +\n          app.forum.attribute(\"blogDefaultImage\")\n        })`\n      : null;\n\n    const blogImage =\n      this.blogMeta && this.blogMeta.featuredImage()\n        ? `url(${this.blogMeta.featuredImage()})`\n        : defaultImage;\n\n    items.add(\n      \"content\",\n      <div className=\"FlarumBlog-Article-Content\">\n        <div\n          className={`FlarumBlog-Article-Image FlarumBlog-default-image`}\n          style={{\n            backgroundImage: blogImage,\n            cursor: \"pointer\",\n          }}\n          onclick={(e) => this.openBlogSettings(e)}\n        />\n\n        <div className={\"FlarumBlog-Article-Content-Edit-Button\"}>\n          <div\n            className={\n              this.languages.length === 0\n                ? \"FlarumBlog-Article-Content-Edit-Dropdown\"\n                : \"FlarumBlog-Article-Content-EditButtons\"\n            }\n          >\n            {this.languages !== null && this.languages.length >= 1 && (\n              <LanguageDropdown\n                selected={this.articleLanguage}\n                onclick={(language) => (this.articleLanguage = language)}\n              />\n            )}\n\n            <Button\n              className={\"Button\"}\n              onclick={(e) => this.openBlogSettings(e)}\n              icon={\"fas fa-pencil-alt\"}\n              loading={this.isSaving}\n            >\n              {app.translator.trans(\n                \"v17development-flarum-blog.forum.composer.update_settings\"\n              )}\n            </Button>\n          </div>\n        </div>\n\n        {/* Article Categories */}\n        <div className={\"FlarumBlog-Article-Categories\"}>\n          {this.tags.map((tag) => (\n            <button\n              class=\"Button Button--text\"\n              onclick={(e) => this.openTagsModal(e)}\n            >\n              {tag.name()}\n            </button>\n          ))}\n\n          <button\n            class=\"Button Button--text\"\n            onclick={(e) => this.openTagsModal(e)}\n          >\n            {this.tags.length === 0\n              ? app.translator.trans(\n                  \"v17development-flarum-blog.forum.composer.select_category\"\n                )\n              : app.translator.trans(\n                  \"v17development-flarum-blog.forum.composer.edit_categories\"\n                )}{\" \"}\n            <i className={\"fas fa-edit\"} />\n          </button>\n        </div>\n\n        <div className={\"FlarumBlog-Article-Post\"}>\n          {/* Article name */}\n          <h3\n            onclick={() => this.openNameArticleModal()}\n            className=\"FlarumBlog-Article-Title\"\n            style={{ cursor: \"pointer\" }}\n          >\n            {this.article && this.article.title() && this.article.title() !== \"\"\n              ? this.article.title()\n              : app.translator.trans(\n                  \"v17development-flarum-blog.forum.composer.no_title\"\n                )}\n\n            <button\n              class=\"Button Button--text\"\n              onclick={(e) => e.preventDefault()}\n            >\n              <i className={\"fas fa-edit\"} />\n            </button>\n          </h3>\n\n          <div className=\"Post-body\">\n            <Composer\n              composer={app.composer}\n              originalContent={\"\"}\n              submitLabel={app.translator.trans(\n                \"v17development-flarum-blog.forum.composer.post_article\"\n              )}\n              placeholder={app.translator.trans(\n                \"v17development-flarum-blog.forum.composer.enter_message_here\"\n              )}\n              onsubmit={() => this.create()}\n              disabled={this.isSaving}\n            />\n          </div>\n        </div>\n      </div>,\n      100\n    );\n\n    items.add(\n      \"commentsPlaceholder\",\n      <div className=\"FlarumBlog-Article-Comments\">\n        <h4>\n          {app.translator.trans(\n            \"v17development-flarum-blog.forum.comment_section.comments\"\n          )}{\" \"}\n          (0)\n        </h4>\n        {/* Locked */}\n\n        <div className=\"Post-body\">\n          <blockquote class=\"uncited\">\n            <div>\n              <span className=\"fas fa-ban\" style={{ marginRight: \"5px\" }} />{\" \"}\n              {app.translator.trans(\n                \"v17development-flarum-blog.forum.composer.comment_section\"\n              )}\n            </div>\n          </blockquote>\n        </div>\n      </div>,\n      90\n    );\n\n    return items;\n  }\n\n  create() {\n    const blogTags = app.forum.attribute(\"blogTags\") || [];\n\n    // Force tags\n    if (this.tags.length === 0) {\n      this.openTagsModal();\n      return;\n    }\n\n    // Force title\n    if (!this.article.title() || this.article.title() === \"\") {\n      this.openNameArticleModal();\n      return;\n    }\n\n    // Find knowledge base tags\n    const findblogTags = this.tags.filter((tag) => {\n      return blogTags.indexOf(tag.id()) >= 0;\n    });\n\n    // No knowledge base tags selected\n    if (findblogTags.length === 0) {\n      alert(\n        app.translator.trans(\n          \"v17development-flarum-blog.forum.composer.no_blog_tags_selected\"\n        )\n      );\n      return;\n    }\n\n    if (\n      (this.blogMeta === null ||\n        (!this.blogMeta.featuredImage() &&\n          !app.forum.attribute(\"blogDefaultImage\")) ||\n        !this.blogMeta.summary()) &&\n      !confirm(\n        app.translator.trans(\n          \"v17development-flarum-blog.forum.composer.post_without_blog_info\"\n        )\n      )\n    ) {\n      return;\n    }\n\n    let relationships = {\n      tags: this.tags,\n    };\n\n    // Add languages if possible\n    if (this.languages.length > 0) {\n      relationships.language = app.store.getBy(\n        \"discussion-languages\",\n        \"code\",\n        this.articleLanguage\n      );\n    }\n\n    const data = {\n      title: this.article.title(),\n      content: app.composer.fields.content(),\n      relationships,\n      blogMeta:\n        this.blogMeta !== null\n          ? {\n              featuredImage: this.blogMeta.featuredImage(),\n              summary: this.blogMeta.summary(),\n              isSized: this.blogMeta.isSized(),\n            }\n          : null,\n    };\n\n    this.isSaving = true;\n\n    this.article\n      .save(data)\n      .then((article) => {\n        setTimeout(() => {\n          // Redirect to the article\n          m.route.set(app.route(\"blogArticle\", { id: `${article.slug()}` }));\n        }, 500);\n      })\n      .catch(() => {\n        this.isSaving = false;\n        m.redraw();\n      });\n  }\n}\n","import { extend } from \"flarum/common/extend\";\nimport IndexPage from \"flarum/forum/components/IndexPage\";\nimport LinkButton from \"flarum/common/components/LinkButton\";\n\nexport default function addSidebarNav() {\n  extend(IndexPage.prototype, \"navItems\", function (items) {\n    if (\n      app.forum.attribute(\"blogAddSidebarNav\") &&\n      app.forum.attribute(\"blogAddSidebarNav\") !== \"0\"\n    ) {\n      items.add(\n        \"blog\",\n        <LinkButton icon=\"fas fa-comment\" href={app.route(\"blog\")}>\n          {app.translator.trans(\"v17development-flarum-blog.forum.blog\")}\n        </LinkButton>,\n        15\n      );\n    }\n\n    return items;\n  });\n}\n","import type Component from \"flarum/common/components/Component\";\nimport Modal from \"flarum/common/components/Modal\";\n\n/**\n * Notice from V17: Temporary override due to lack of multi-dialogs!\n *\n * We'll open a PR to support multi-dialog to the Flarum main repo\n */\n\n/**\n * Ideally, `show` would take a higher-kinded generic, ala:\n *  `show<Attrs, C>(componentClass: C<Attrs>, attrs: Attrs): void`\n * Unfortunately, TypeScript does not support this:\n * https://github.com/Microsoft/TypeScript/issues/1213\n * Therefore, we have to use this ugly, messy workaround.\n */\ntype UnsafeModalClass = ComponentClass<any, Modal> & {\n  isDismissible: boolean;\n  component: typeof Component.component;\n};\n\n/**\n * Class used to manage modal state.\n *\n * Accessible on the `app` object via `app.modal` property.\n */\nexport default class OverrideModalState {\n  /**\n   * @internal\n   */\n  modal: null | {\n    componentClass: UnsafeModalClass;\n    attrs?: Record<string, unknown>;\n    key: number;\n  } = null;\n\n  modalList: Array = [];\n\n  /**\n   * Used to force re-initialization of modals if a modal\n   * is replaced by another of the same type.\n   */\n  private key = 0;\n\n  private closeTimeout?: NodeJS.Timeout;\n\n  /**\n   * Shows a modal dialog.\n   *\n   * If a modal is already open, the existing one will close and the new modal will replace it.\n   *\n   * @example <caption>Show a modal</caption>\n   * app.modal.show(MyCoolModal, { attr: 'value' });\n   *\n   * @example <caption>Show a modal from a lifecycle method (`oncreate`, `view`, etc.)</caption>\n   * // This \"hack\" is needed due to quirks with nested redraws in Mithril.\n   * setTimeout(() => app.modal.show(MyCoolModal, { attr: 'value' }), 0);\n   */\n  show(\n    componentClass: UnsafeModalClass,\n    attrs: Record<string, unknown> = {},\n    keepLast: Boolean = false\n  ): void {\n    if (!(componentClass.prototype instanceof Modal)) {\n      // This is duplicated so that if the error is caught, an error message still shows up in the debug console.\n      const invalidModalWarning = \"The ModalManager can only show Modals.\";\n      console.error(invalidModalWarning);\n      throw new Error(invalidModalWarning);\n    }\n\n    if (this.closeTimeout) clearTimeout(this.closeTimeout);\n\n    // Open new modal\n    this.modal = { componentClass, attrs, key: this.key++ };\n\n    // Remember previously opened modal\n    if (keepLast) {\n      this.modalList.push(this.modal);\n    } else {\n      // Override last modals\n      this.modalList = [this.modal];\n    }\n\n    m.redraw.sync();\n  }\n\n  /**\n   * Closes the currently open dialog, if one is open.\n   */\n  close(): void {\n    if (!this.modal) return;\n\n    // There are more modals currently opened\n    // Close current and open last in list\n    if (this.modalList.length >= 2) {\n      $(`.modal[modal-key=${this.modal?.key}]`)\n        .one(\"hide.bs.modal\", () => {\n          const currentModalPosition = this.modalList.indexOf(this.modal);\n\n          // Remove last modal from list\n          this.modalList.splice(currentModalPosition, 1);\n\n          // Open last modal from list\n          this.modal = this.modalList[this.modalList.length - 1];\n\n          setTimeout(() => {\n            $(document.body).addClass(\"modal-open\");\n          }, 1000);\n\n          m.redraw();\n        })\n        .modal(\"hide\");\n\n      m.redraw();\n      return;\n    }\n\n    // Don't hide the modal immediately, because if the consumer happens to call\n    // the `show` method straight after to show another modal dialog, it will\n    // cause Bootstrap's modal JS to misbehave. Instead we will wait for a tiny\n    // bit to give the `show` method the opportunity to prevent this from going\n    // ahead.\n\n    this.closeTimeout = setTimeout(() => {\n      $(`.modal[modal-key=${this.modal?.key}]`)\n        .modal(\"hide\")\n        .one(\"hide.bs.modal\", () => {\n          this.modal = null;\n\n          m.redraw();\n        });\n    });\n  }\n\n  /**\n   * Checks if a modal is currently open.\n   *\n   * @return `true` if a modal dialog is currently open, otherwise `false`.\n   */\n  isModalOpen(): boolean {\n    return !!this.modal;\n  }\n}\n","import BlogItem from \"./pages/BlogItem\";\nimport Model from \"flarum/common/Model\";\nimport Tag from \"flarum/tags/models/Tag\";\nimport Discussion from \"flarum/common/models/Discussion\";\nimport BlogOverview from \"./pages/BlogOverview\";\nimport redirector from \"./utils/redirector\";\nimport BlogMeta from \"../common/Models/BlogMeta\";\nimport extendTagOverview from \"./utils/extendTagOverview\";\nimport discussionRouting from \"./utils/discussionRouting\";\nimport BlogComposer from \"./pages/BlogComposer\";\nimport compat from \"./compat\";\nimport addSidebarNav from \"./utils/addSidebarNav\";\nimport app from \"flarum/forum/app\";\n\n// Create our own modal manager\nimport OverrideModalState from \"./states/OverrideModalState\";\nimport overrideModalManager from \"./utils/overrideModalManager\";\n\n// Register Flarum Blog\napp.initializers.add(\n  \"v17development-flarum-blog\",\n  (app) => {\n    app.routes.blog = { path: \"/blog\", component: BlogOverview };\n\n    app.routes.blogCategory = {\n      path: \"/blog/category/:slug\",\n      component: BlogOverview,\n    };\n\n    app.routes.blogComposer = {\n      path: \"/blog/compose\",\n      component: BlogComposer,\n    };\n\n    app.routes.blogArticle = { path: \"/blog/:id\", component: BlogItem };\n\n    app.routes[\"blogArticle.near\"] = {\n      path: \"/blog/:id/:near\",\n      component: BlogItem,\n    };\n\n    app.store.models.blogMeta = BlogMeta;\n\n    Discussion.prototype.blogMeta = Model.hasOne(\"blogMeta\");\n    Tag.prototype.isBlog = Model.attribute(\"isBlog\");\n\n    // Redirect discussions/tags to their blog post/overview\n    redirector();\n\n    // Extend tag overview.\n    // Hide tags which are used as blog category\n    extendTagOverview();\n\n    // Make that blog articles have a blog route and not a discussion route\n    discussionRouting();\n\n    // Add a link to the blog to the IndexPage sidebar, if enabled.\n    addSidebarNav();\n\n    /**\n     * Notice from V17: Temporary override due to lack of multi-dialogs!\n     *\n     * We'll open a PR to support multi-dialog to the Flarum main repo\n     */\n    overrideModalManager();\n    app.modal = new OverrideModalState();\n  },\n  -100000\n);\n\ncompat();\n","import IndexPage from \"flarum/forum/components/IndexPage\";\nimport DiscussionPage from \"flarum/forum/components/DiscussionPage\";\nimport { extend, override } from \"flarum/common/extend\";\nimport app from \"flarum/forum/app\";\n\nexport default function () {\n  // Redirect tag to blog category\n  extend(IndexPage.prototype, \"oncreate\", function () {\n    const tag = this.currentTag();\n    const tagRedirectEnabled =\n      app.forum.attribute(\"blogRedirectsEnabled\") === \"both\" ||\n      app.forum.attribute(\"blogRedirectsEnabled\") === \"tags_only\";\n\n    // Only trigger when it's a tag page and the redirects are enabled\n    if (tag && tagRedirectEnabled) {\n      const blogTags = app.forum.attribute(\"blogTags\");\n\n      // Tag is inside list\n      if (\n        blogTags.indexOf(tag.id()) >= 0 ||\n        (tag.parent() && blogTags.indexOf(tag.parent().id()) >= 0)\n      ) {\n        m.route.set(app.route(\"blog\"));\n      }\n    }\n  });\n\n  // Redirect discussion to blog article\n  override(DiscussionPage.prototype, \"show\", function (original, discussion) {\n    const discussionRedirectEnabled =\n      app.forum.attribute(\"blogRedirectsEnabled\") === \"both\" ||\n      app.forum.attribute(\"blogRedirectsEnabled\") === \"discussions_only\";\n\n    if (\n      discussionRedirectEnabled &&\n      discussion &&\n      discussion &&\n      discussion.tags().length > 0\n    ) {\n      const blogTags = app.forum.attribute(\"blogTags\");\n\n      const foundTags = discussion.tags().filter((tag) => {\n        return (\n          blogTags.indexOf(tag.id()) >= 0 ||\n          (tag.parent() && blogTags.indexOf(tag.parent().id()) >= 0)\n        );\n      });\n\n      // Only redirect if the discussion has blog tags\n      if (foundTags.length > 0) {\n        // Redirect to blog article\n        const url = app.route(\"blogArticle\", {\n          id: discussion.slug(),\n        });\n\n        m.route.set(url, null, { replace: true });\n\n        return null;\n      }\n    }\n\n    return original(discussion);\n  });\n}\n","import ModalManager from \"flarum/forum/components/ModalManager\";\nimport { override } from \"flarum/common/extend\";\n\n/**\n * Notice from V17: Temporary override due to lack of multi-dialogs!\n *\n * We'll open a PR to support multi-dialog to the Flarum main repo\n */\n\nexport default function overrideModalManager() {\n  override(ModalManager.prototype, \"view\", function () {\n    return this.attrs.state.modalList.map((modal) => {\n      const Tag = modal?.componentClass;\n\n      return (\n        <div className=\"ModalManager modal fade\" modal-key={modal.key}>\n          {!!Tag && (\n            <Tag\n              key={modal?.key}\n              {...modal.attrs}\n              animateShow={this.animateShow.bind(this)}\n              animateHide={this.animateHide.bind(this)}\n              state={this.attrs.state}\n            />\n          )}\n        </div>\n      );\n    });\n  });\n\n  override(ModalManager.prototype, \"animateHide\", function () {\n    if (this.attrs.state.modalList.length === 1) {\n      this.modalShown = false;\n    }\n  });\n\n  override(\n    ModalManager.prototype,\n    \"animateShow\",\n    function (readyCallback = () => {}) {\n      if (!this.attrs.state.modal) return;\n\n      const dismissible = !!this.attrs.state.modal.componentClass.isDismissible;\n\n      this.modalShown = true;\n\n      // If we are opening this modal while another modal is already open,\n      // the shown event will not run, because the modal is already open.\n      // So, we need to manually trigger the readyCallback.\n      if ($(`.modal[modal-key=${this.attrs.state.modal.key}]`).hasClass(\"in\")) {\n        readyCallback();\n        return;\n      }\n\n      setTimeout(() => {\n        $(`.modal[modal-key=${this.attrs.state.modal.key}]`)\n          .one(\"shown.bs.modal\", readyCallback)\n          // @ts-expect-error: No typings available for Bootstrap modals.\n          .modal({\n            backdrop: dismissible || \"static\",\n            keyboard: dismissible,\n            show: true,\n          });\n      }, 1);\n    }\n  );\n}\n","import { compat } from \"@flarum/core/forum\";\nimport BlogAuthor from \"./components/BlogItemSidebar/BlogAuthor\";\nimport BlogItemSidebar from \"./components/BlogItemSidebar/BlogItemSidebar\";\nimport BlogOverviewItem from \"./components/BlogOverviewItem\";\nimport BlogPostController from \"./components/BlogPostController\";\nimport FeaturedBlogItem from \"./components/FeaturedBlogItem\";\nimport ForumNav from \"./components/ForumNav\";\nimport BlogItem from \"./pages/BlogItem\";\nimport BlogOverview from \"./pages/BlogOverview\";\n\nexport default () => {\n  Object.assign(compat, {\n    \"v17development/blog/components/BlogItemSidebar\": BlogItemSidebar,\n    \"v17development/blog/components/BlogAuthor\": BlogAuthor,\n    \"v17development/blog/components/ForumNav\": ForumNav,\n    \"v17development/blog/components/BlogPostController\": BlogPostController,\n    \"v17development/blog/components/BlogOverviewItem\": BlogOverviewItem,\n    \"v17development/blog/components/FeaturedBlogItem\": FeaturedBlogItem,\n    \"v17development/blog/pages/BlogItem\": BlogItem,\n    \"v17development/blog/pages/BlogOverview\": BlogOverview,\n  });\n};\n"],"sourceRoot":""}